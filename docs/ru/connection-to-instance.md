# 3. Подключение к инстансу AWS

[SSH](https://ru.wikipedia.org/wiki/SSH) - это безопасный протокол удаленного управления компьютерными устройствами. 

## 3.1. Подключение по SSH c компьютера на Windows

Для подклюения к комьпютера с Windows, прежде необходимо скачать и установить программу [Putty](https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html). 

### 3.1.1. Импорт приватного ключа для Putty
3.1.1.1. После установки Putty, необходимо запустить утилиту PuTTYgen идущую с ней в комплекте, для импорта ключа сертификта в формате PEM, в формат, пригодный для использования в программе Putty. Для этого в верхнем меню выбираем пункт **Conversions->Import Key**

![1](/images/ru/ssh1.jpg)

#### 3.1.1.2. Выбор ключа AWS в формате PEM
Далее, выбираем ключ, который мы ранее сохранили на этапе [2.1.7.1](create-aws-instance.html#_2-1-7-1-сохранение-кnючей-доступа), в нашем случае его имя ***wireguard-awskey.pem***

![2](/images/ru/ssh2.jpg)

#### 3.1.1.3. Задание параметров импорта ключа
На этом шаге нам необходимо указать комментарий для этого ключа (описание) и задать для безопасности пароль и его подтверждение. Он будет запрашиваться при каждом подключении. Таким образом мы защищаем ключ паролем от нецелевого использования. Пароль можно не задавать, но это менее безопасно, в случае, если ключ попадет в чужие руки. После нажимаем кнопку **Save private key**

![3](/images/ru/ssh3.jpg)

#### 3.1.1.4. Сохранение импортированного ключа
Открывается диалоговое окно сохранения файла, и мы сохраняем наш приватный ключ в виде файла с расширением `.ppk`, пригодного для использования в программе ***Putty***.
Указываем имя ключа (в нашем случае `wireguard-awskey.ppk`) и нажимаем кнопку **Сохранить**. 

![4](/images/ru/ssh4.jpg)

### 3.1.2. Создание и настройка соединения в Putty

#### 3.1.2.1. Создание соединения
Открываем программу Putty, выбираем категорию **Session** (она открыта по умолчанию) и в поле **Host Name** вводим публичный IP адрес нашего сервера, который мы получили на шаге [2.2.3](create-aws-instance.html#_2-2-3-обзор-резуnьтатов-создания-внешнего-ip-адреса). В поле **Saved Session** вводим произвольное название нашего соединения (в моем случае *wireguard-aws-london*), и далее нажимаем кнопку **Save** чтобы сохранить сделанные нами изменения. 

![5](/images/ru/ssh5.jpg)

#### 3.1.2.2. Настройка автологина пользователя
Дальше в категории ***Connection***, выбираем подкатегорию ***Data*** и в поле **Auto-login username** водим имя пользователя **ubuntu** - это стандартный пользователь инстанса на AWS с Ubuntu. 

![6](/images/ru/ssh6.jpg)

#### 3.1.2.3. Выбор приватного ключа для соединения по SSH
Затем переходим в подкатегорию ***Connection/SSH/Auth*** и рядом с полем **Private key file for authentication** нажимаем на кнопку **Browse...** для выбора файла с сертификатом ключа. 

![7](/images/ru/ssh7.jpg)

#### 3.1.2.4. Открытие импортированного ключа
Указываем ключ, импортированный нами ранее на этапе [3.1.1.4](#_3-1-1-4-сохранение-импортированного-кnюча), в нашем случае это файл *wireguard-awskey.ppk*, и нажимаем кнопку **Открыть**.

![8](/images/ru/ssh8.jpg)


#### 3.1.2.5. Сохранение настроек и запуск подключения
Вернувшись на страницу категории ***Session*** нажимаем еще раз кнопку **Save**, для сохранения сделанных ранее нами изменний на предыдущих шагах ([3.1.2.2](#_3-1-2-2-настройка-автоnогина-поnьзоватеnя) - [3.1.2.4](#_3-1-2-4-открытие-импортированного-кnюча)). И затем нажимаем кнопку **Open** чтобы открыть созданное и настроенное нами удаленное подключение по SSH. 

![10](/images/ru/ssh10.jpg)

#### 3.1.2.7. Настройка доверия между хостами
На следующем шаге, при первой попытке подключится, нам выдается предупреждение, у нас не настроено доверие между двумя компьютерами, и спрашивает, доверять ли удаленному компьютеру. Мы нажимем кнопку **Да**, тем самым добавляя его в список доверенных хостов. 

![11](/images/ru/ssh11.jpg)

#### 3.1.2.8. Ввод пароля для доступа к ключу
После этого открыается окно терминала, где запрашивается пароль к ключу, если вы его устанавливали ранее на шаге [3.1.1.3](l#_3-1-1-3-задание-параметров-импорта-кnюча). При вводе пароля никаких действий на экране не происходит. Если ошиблись, можете использовать клавишу *Backspace*.

![12](/images/ru/ssh12.jpg)

#### 3.1.2.9. Приветственное сообщение об успешном подключении
После успешного ввода пароля, нам отображается в терминале текст приветствия, который сообщает что удаленная система готова к выполнению наших команд.

![13](/images/ru/ssh13.jpg)